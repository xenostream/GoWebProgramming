# REST

RESTful, 그리고 현재 가장 유행하고있는 인터넷 소프트웨어 프레임 워크입니다. 구조가 명료 표준에 맞고 이해하기 쉽고 확장에 유용합니다. 따라서 바로 많은 홈페이지에서 채용되고 있습니다. 이 절에서는 이것이 도대체 어떤 프레임 워크인지 Go에서 어떻게 실현 하는가를 배우게됩니다.
## REST 란 무엇인가
REST (Representational State Transfer)라는 개념은 2000 년 Roy Thomas Fielding (그는 HTTP 사양의 주요 저자 중 한 명입니다.) 박사 학위 논문에서 처음 등장했습니다. 이 안에있는 프레임 워크의 제약 조건과 원칙에 대해 다루고 있습니다. 이러한 제약 조건과 원칙을 만족하는 응용 프로그램이나 디자인은 RESTful 것입니다.

REST가 무엇인지 이해하기 위해서는 다음과 같은 몇 가지 개념을 이해할 필요가 있습니다 :

- 자원 (Resources)
REST는 "프레젠테이션 계층의 상태 변화"입니다. 이것은 주어가 생략되어 있습니다. "프레젠테이션 계층"이라는 것은 "자원"의 "프레젠테이션 계층"입니다.

는 자원은 무엇일까요? 평소 우리가 사용하는 이미지, 문서, 영상 등입니다. 이러한 자원은 URI에 의해 식별됩니다. 즉 하나의 URI가 하나의 리소스를 나타냅니다.

- 프레젠테이션 계층 (Representation)

자원의 구체적인 실체를 수반하는 정보를 만듭니다. 이것은 여러 가지 표현 방법을 가지고 있으며, 실체의 표현 이야말로 프레젠테이션 계층입니다. 예를 들어 txt 텍스트 정보가 있다면, 이것은 html, json, xml 등의 형식으로 출력 할 수 있습니다. 이미지는 jpg, png 등의 방법으로 표현할 수 있습니다. 이 프레젠테이션 계층의 의미입니다.

URI는 하나의 자원을 확정합니다. 그러나 어떻게이 구체적인 표현 형식을 확정하는 것입니까? HTTP 요청 헤더 정보에서 Accept 및 Content-Type 필드를 이용하여 지정되어있는 것입니다. 이 두 필드 이야말로 "프레젠테이션 계층"에 대한 묘사입니다.

- 상태 천이 (State Transfer)

있는 홈페이지를 방문하는 것은 클라이언트가 서버와 상호 작용 과정을 나타냅니다. 이 과정에서 반드시 데이터 및 상태 전이가 관여합니다. HTTP 프로토콜은 비 상태이므로, 이러한 상태는 서버에 저장되어있을 것입니다. 따라서 만약 클라이언트가 서버에 데이터의 변경과 상태 전이를 통지하고 싶을 경우 어떤 방법으로이를 통지해야합니다.

클라이언트가 서버에 알릴 방법은 HTTP 프로토콜 밖에 없습니다. 구체적으로는 HTTP 프로토콜 안에있는 4 개의 조작 방법을 나타내는 동사 : GET, POST, PUT 및 DELETE입니다. 이들은 4 개의 기본 작업으로 나뉩니다 : GET은 리소스를 검색하는 데 사용됩니다. POST는 자원을 새로 만드는 데 사용됩니다 (자원 업데이트에 사용할 수 있습니다). PUT은 자원의 갱신에 사용됩니다. DELETE는 자원의 제거에 사용됩니다.

위의 해석을 종합하여 RESTful 프레임 워크 란 무엇 정리해 보겠습니다 :

- (1) 각 URI가 하나의 자원을 나타내는
- (2) 클라이언트와 서버간에 이러한 자원의 뭔가의 프레젠테이션 계층을 전송하는
- (3) 클라이언트는 4 개의 HTTP 동사를 통해 서버의 자원에 대해 작업을 실시한다. "프리젠 테이션 계층의 상태 전이"의 실현.


Web 어플리케이션이 충족되어야 REST의 가장 중요한 규칙은 : 클라이언트와 서버 간의 상호 작용에 요청 사이는 무국적이라는 것입니다. 즉, 클라이언트에서 서버에 각 요청은 요청이 필요로하는 정보를 포함해야합니다. 서버가 요구 사이의 어떤 시점에서 다시 시작해도 클라이언트는 그 통지를받을 수 없습니다. 또한이 요청은 어떤 유효한 서버에서 따라 답변 수 있습니다. 이것은 클라우드 컴퓨팅과 같은 환경에 충분히 적합합니다. 비 상태이므로 클라이언트는 데이터를 캐싱하여 성능을 향상시킬 수 있습니다.

또 하나 중요한 REST 규칙은 시스템의 분리입니다. 이것은 모듈이 이것과 직접 상호 작용하는 계층의 모듈을 제외하고 해제 할 수 없음을 보여줍니다. 시스템의 알 수있는 내용을 하나의 레이어로 제한함으로써 전체 시스템의 복잡성을 제한 할 수 있습니다. 따라서 낮은 계층의 독립성을 촉진 할 수 있습니다.

아래의 그림은 REST의기구 도표입니다 :

! [] (images / 8.3.rest2.png? raw = true)

그림 8.5 REST기구 도표

REST 프레임 워크의 제약 조건을 전체에 적용 할 때 대량의 클라이언트로 확장 할 수있는 애플리케이션 프로그램을 생성 할 수 있습니다. 또한 클라이언트와 서버 간의 상호 작용의 지연도 줄일 수 있습니다. 통일 된 인터페이스가 시스템 프레임 워크의 전체를 단순화하고 하위 시스템 간의 상호 작용의 전망을 개선합니다. REST는 클라이언트와 서버의 구현을 단순화하고 REST를 사용하여 개발 된 응용 프로그램 프로그램을 더 확장하기 쉽게합니다.

아래는 REST의 확장 성을 보여줍니다 :

! [] (images / 8.3.rest.png? raw = true)

그림 8.6 REST의 확장 성

## RESTful 구현
Go는 REST에 대한 직접적인 지원은하지 않습니다. 그러나 RESTful 한 web 어플리케이션은 HTTP 프로토콜을 기반으로 구현되는 것이므로,`net / http` 패키지를 이용하여 직접 구현할 수 있습니다. 당연히 REST에 대한 몇 가지 개조를해야합니다. REST는 다른 method에 의해 해당 자원을 처리합니다. 현재 이미 많은 자칭 REST 애플리케이션은 사실 정말 REST를 구현하고있는 것은 아닙니다. 여기에서는 우선 이러한 애플리케이션을 구현하는 방법에 따라 여러 단계로 나누어 보겠습니다 다음 그림을 참조하십시오 :

! [] (images / 8.3.rest3.png? raw = true)

그림 8.7 REST의 학급 편성

위의 그림은 우리가 현재 구현하고있는 REST의 3 개의 level을 보여줍니다. 우리가 응용 프로그램을 개발할 때도 반드시 모든 RESTful 규칙을 하루 계속 그 방식을 구현하고있는 것은 아닙니다. 왜냐하면 어떤 때는 RESTful 방식을 완전히 참조하지 않아도 괜찮 때문입니다. RESTful 서비스는`DELETE`와`PUT`을 포함한 각 HTTP 방식을 충분히 활용합니다. 그러나있을 때 HTTP 클라이언트는`GET`와`POST` 요청 만 보낼 수 있습니다 :

- HTML 표준은 링크와 폼 통해서만`GET`와`POST`을 지원하고 있습니다. Ajax를 지원하지 않는 웹 브라우저는`PUT`과`DELETE` 명령을 보낼 수 없습니다.

- 방화벽은 HTTP의`PUT`와`DELETE` 요청 차단 수 있으며,이 제한을 해결하기 위해 클라이언트의 실제`PUT`와`DELETE` 요청을 POST 요청에서 통과시켜 나가지 않으면 안됩니다 않습니다. 따라서 RESTful 서비스는받은 POST 요청에서 원래의 HTTP 메소드를 찾아내는 방법과 복원 방법을 할 책임이 있습니다.

현재`POST` 속에서 숨겨진 필드 인`_method`을 증가하는 등의 방법으로`PUT``DELETE` 같은 메소드를 에뮬레이트 할 수 있습니다. 그러나 서버에서 변환을 수행해야합니다. 현재 내 프로젝트에서 이러한 방법으로 REST 인터페이스를 작성하고 있습니다. 당연히 Go 언어에서는 완전히 RESTful에 따른 구현하는 것은 쉽습니다. 아래의 예를 통해 어떻게 RESTful 애플리케이션의 설계를 실현하거나 설명합시다.

package main

import (
"fmt"
"github.com/drone/routes"
"net / http"
)

func getuser (w http.ResponseWriter, r * http.Request) {
params : = r.URL.Query ()
uid : = params.Get ( ": uid")
fmt.Fprintf (w "you are get user % s", uid)
}

func modifyuser (w http.ResponseWriter, r * http.Request) {
params : = r.URL.Query ()
uid : = params.Get ( ": uid")
fmt.Fprintf (w "you are modify user % s", uid)
}

func deleteuser (w http.ResponseWriter, r * http.Request) {
params : = r.URL.Query ()
uid : = params.Get ( ": uid")
fmt.Fprintf (w "you are delete user % s", uid)
}

func adduser (w http.ResponseWriter, r * http.Request) {
params : = r.URL.Query ()
uid : = params.Get ( ": uid")
fmt.Fprint (w "you are add user % s", uid)
}

func main () {
mux : = routes.New ()
mux.Get ( "/ user / : uid"getuser)
mux.Post ( "/ user / : uid"modifyuser)
mux.Del ( "/ user / : uid"deleteuser)
mux.Put ( "/ user /"adduser)
http.Handle ( "/", mux)
http.ListenAndServe ( ": 8088", nil)
}

위의 코드는 어떻게 REST 애플리케이션을 쓰거나 보시고했습니다. 우리가 사용하는 자원은 사용자입니다. 다른 method에 의해 다른 함수에 접근했습니다. 여기에서는 타사 라이브러리`github.com / drone / routes`을 사용하고 있습니다. 앞 장에서 어떻게 스스로 정의한 라우터를 제공하거나 소개했습니다. 이 라이브러리는 사용자가 정의한 루트와 편리한 경로 규칙을 반영합니다. 이를 사용하여 쉽게 REST 프레임 워크를 구현할 수 있습니다.

## 정리
REST는 프레임 워크 스타일의 일종입니다. WWW의 성공 경험을 짐작하고 있습니다 : 무국적 자원을 중심으로 HTTP 프로토콜과 URI 프로토콜을 충분히 이용하고 있습니다. 통일 된 인터페이스 정의를 제공하고, Web 서비스를 설계하는 방법의 하나로서 유행했습니다. 어떤 의미에서 URI와 HTTP 같은 여명기의 Internet 표준을 강조하여 REST는 대형 어플리케이션 프로그램 서버 시대 이전의 Web 방식으로 회귀하고 있습니다. 지금까지 Go의 REST에 대한 지원은 여전히​​ 간단합니다. 스스로 정의한 라우팅을 통해 다른 method에 다른 handle을 구현할 수 있습니다. 이와 같이 REST 프레임 워크는 실현되고 있습니다.


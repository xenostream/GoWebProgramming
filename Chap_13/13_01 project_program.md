# Project Program

무슨 작업을 하던지 먼저 계획을 작성하는 것은 매우 중요 합니다. 우리는 블로그 시스템을 개발하기 전 프로젝트의   
계획을 먼저 만들고 시작 하도록 하겠습니다. 

프로젝트의 디렉토리 구조를 어떻게 설정할지와 프로젝트 전과정을 그림을 통해서 이해하거나 응용 프로그램의 실행   
과정을 먼저 이해하고 개발할 경우 코딩 설계시에도 상대적으로 쉽고 오류도 줄어들 것입니다.


## gopath 및 프로젝트 설정
프로젝트 개발용  `gopath`를  파일시스템의 디렉토리를 기준으로 지정합니다. 이 디렉토리는 당연히 자유형식으로     
디렉토리 이름을 설정할 수 있습니다. 디렉토리를 생성한 다음에 이 경로를 `GOPATH` 환경변수에 추가 합니다.    
`GOPATH` 환경변수는 프로젝트마다 설정해서 사용할 수 있으며, 해당 디렉토리에는 여러개의 기본 디렉토리가 포함됩니다.    
예를 들어 `window 시스템`에서의  환경 변수를 설정하는 것을 설명하겠습니다.    
`linux/MacOS` 시스템에서는 터미널 창에서 `export gopath=/home/astaxie/gopath` 명령을 입력하면 됩니다.   
또한 반드시 `gopath` 디렉토리에는 3개의 디렉토리, 즉  `pkg, bin, src` 디렉토리가 존재해야만 합니다. 

새로 만든 프로젝트의 소스 코드는 `$GOPATH/src` 디렉토리 아래에 놓습니다.    
현재 개발하는 블로그 프로젝트의 디렉토리를 `beeblog`라고 가정하겠습니다. 다음은 window에서의 환경 변수와 디렉토리  
구조의 스크린 샷입니다.

! [] (images / 13.1.gopath.png? raw = true)

그림 13.1 환경 변수 GOPATH 설정

! [] (images / 13.1.gopath2.png? raw = true)

그림 13.2 작업 디렉토리는 $gopath/src 아래에 있습니다


## 응용 프로그램의 프로세스 다이어그램
블로그 시스템은 `모델-뷰-컨트롤러`(이하 MVC) 설계 모드를 기반으로 작성 합니다. MVC는 애플리케이션 프로그램의   
논리 계층과 프레젠테이션 계층을 분리하여 개발하는 방식 입니다. 
구성 방식에서 프레젠테이션 계층을  Go에서 분리하기 때문에,웹 페이지는 약간의 스크립트를 포함하는 것만으로도   
구현이 가능하다는 장점이 있습니다. 자세한 것은 디자인패턴 관련 문서를 참조하시기 바랍니다.

- `모델`(Model)은 데이터 구조를 나타냅니다.    
   일반적으로 모델 클래스는 데이터베이스의 데이터를 검색하거나 삽입하고 업데이트하는 등의 기능을 포함 합니다.
- `뷰`(View)는 사용자의 정보를 표시하는 구조 및 스타일입니다.   
   일반적으로 하나의 뷰는 하나의 웹 페이지와 매핑 됩니다. Go에서는 하나의 뷰 페이지의 일부분이라고 생각해도    
   괜찮습니다. 예를 들어, 머리글, 바닥 글 등이 뷰에 해당 합니다. RSS 페이지와 같은  다른 종류의 "페이지"라도    
   상관 없습니다. Go에서는 template 패키지가  이미 이러한 View 계층에서 사용하는 기능을 구현하고 있습니다.   
- `컨트롤러`(Controller)는 모델, 뷰 및 기타 모든 HTTP 요청을 필요로 하는 자원 간의 중개를 처리하고 웹 페이지를   
   생성하는 역활을 맡고 있습니다. 

다음 그림은 프로젝트 설계 단계에서 프레임워크의  데이터가 어떻게 시스템 전체에서 움직이는 지를 나타냅니다.   

! [] (images / 13.1.flow.png? raw = true)

그림 13.3 프레임워크의 데이터 흐름(Data WalkFlow)

1. main.go는 응용 프로그램의 시작점 입니다.    
   블로그를 실행하는 데 필요한 기본 자원을 초기화하고 정보를 설정하고 포트를 모니터링 합니다.   
2. 라우팅 기능은 사용자의 HTTP 요청을 검사하여 URL에 해당하는 `method`를 매핑해주는 기능을 합니다.(리다이렉션)   
3. 만약 캐시 파일이 존재하는 경우, 일반적인 처리방식을 무시하고 저장된 캐시를 브라우저로 직접 전송 합니다.    
4. 보안 검사 : 응용 프로그램의 컨트롤러가 호출되기 전에 HTTP 요청 및 어떤 사용자가 전송 한 데이터에  필터를   
   설정하여 사용자가 입력한 데이터와 요청사항에 대하여 여러가지 검사를 수행할 수 있습니다.   
5. 컨트롤러가 모델 코어 라이브러리 보조 함수 및 특정 요청에 필요한 추가 자료의 처리 기능을 로드 합니다.   
   컨트롤러에서는 업무 로직 처리에 대한 것을 주로 구현하게 됩니다.   
6. 뷰 계층에서 출력 된 내용은 Web 브라우저에게 콘텐츠 형태로 전송 됩니다.   
   캐시가 저장되지 않았다면, 일반적인 요청 프로세스대로 처리합니다.

## 디렉토리 구조
상기의  프로그램의 프로세스 설계에 따라 블로그 디렉토리의  구조는 다음과 같습니다. 
```
| --main.go         시작 파일
| --conf            설정 파일 및 처리 모듈
| --controllers     컨트롤러 
| --models          데이터베이스 처리 모듈
| --utils           보조 함수 라이브러리
| --static          정적 파일 디렉토리
| --views           뷰 관련 라이브러리
```

## 프레임 워크 설계
블로그의 빠른 개발 및 실행을 위해, 상기의  프로세스 설계에 기초한 최소화 된 프레임워크를 개발 합니다.  
프레임워크는 라우팅 기능, REST를 지원하는 컨트롤러, 자동화 및 템플릿 적용,  로그 시스템 설정관리 등이 포함 됩니다.  


## 정리
이 절에서는 블로그 시스템에서 `GOPATH`를  설정하는 방법과, 디렉토리 생성 등의 기초적인 부분을 설명했습니다.  
프레임워크의 구조를  MVC 모드로 설정하고, 블로그 시스템의 데이터 흐름과  실행 과정에 대해서 간단히 알아봤습니다.  

마지막으로 이런 과정을 거쳐서 블로그 시스템의  디렉토리 구조를 설계 했습니다.   
지금까지의 작업으로 프레임워크의 기본적인 설정이 완료 되었습니다. 이후 몇 절에서 각각에 대해서 구현 하겠습니다.

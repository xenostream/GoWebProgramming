# Time Zone

## Locale 란 무엇인가
Locale은 세계의 특정 지역을 표현한 텍스트와 언어 습관 설정의 집합입니다. locale 이름은 보통 세 부분으로 구성되어 있습니다 : 첫 번째 부분은 강제적 인 것이 언어의 생략을 나타냅니다. 예를 들어 "en"은 영어를 나타내고 "zh"는 중문을 나타냅니다. 두 번째 부분은 밑줄을 하나두고 옵션이되는 나라의 설명 기호가 들어 있습니다. 같은 언어가 다른 국가를 구별하기 위해 사용됩니다. 예를 들어 "en_US"는 미국 영어를 나타내고 "en_UK"는 영국 영어를 나타냅니다. 마지막 부분은 마침표를 끼고 옵션이되는 문자 encode 방식의 설명 기호입니다. 예를 들어 "zh_CN.gb2312"중국에서 사용되는 gb2312 encode 방식을 나타냅니다.

GO 언어는 기본적으로 "UTF-8"인코딩 방식을 채용하고 있습니다. 그래서 i18n을 구현할 때 세 번째 부분은 고려하지 않습니다. 이상에서 locale가 표현하기 전에 두 부분으로 가지고 i18n 표준 locale 이름합니다.


> Linux 및 Solaris 시스템에서는`locale -a` 명령을 사용하여 지원되는 모든 지역 이름을 나열 할 수 있습니다. 독자는이 지역 이름의 명명 규칙을 볼 수 있습니다. BSD 같은 시스템에서 locale 명령은 없습니다. 그러나 지역 정보는 / usr / share / locale에 저장되어 있습니다.

## Locale를 설정
위의 locale에 대한 정의에서 사용자의 정보 (액세스 정보, 개인 정보, 액세스 도메인 이름 등)에 따라 이에 대응하는 locale을 설정해야합니다. 다음의 몇 가지 방법을 사용하여 사용자의 locale을 설정 할 수 있습니다.

### 도메인 이름으로 Locale를 설정
Locale 설정은 응용 프로그램이 실행될 때 도메인에 의해 구분할 수 있습니다. 예를 들어, www.asta.com을 우리의 영어 사이트 (기본 사이트)으로서 www.asta.cn이라는 도메인 이름을 중국어 사이트로했다고합니다. 이 경우 응용 프로그램에서는 도메인 이름과 해당 locale의 대응 관계를 설정하여 지역을 설정 s るうこと 수 있습니다. 이러한 처리는 몇 가지 장점이 있습니다 :

- URL을 보는 것만으로 쉽게 식별 할 수
- 사용자는 도메인 이름을 통해 직관적으로 어떤 언어의 사이트에 방문하는지 알 수있다.
- Go 프로그램에서는 구현이 매우 간단하고 편리합니다. map를 하나 사용하는 것만으로 실현할 수있다.
- 검색 엔진 말기에 유리. 사이트의 SEO를 높일 수있다.

아래의 코드는 도메인 이름의 해당 locale을 제공합니다 :

if r.Host == "www.asta.com"{
i18n.SetLocale ( "en")
} else if r.Host == "www.asta.cn"{
i18n.SetLocale ( "zh-CN")
} else if r.Host == "www.asta.tw"{
i18n.SetLocale ( "zh-TW")
}

당연히 전체 도메인 이름으로 지역을 설정하는 것 외에 하위 도메인에 의해 지역을 설정 할 수 있습니다. 예를 들어 "en.asta.com"영어 사이트를 나타내고, "cn.asta.com"이 중문 사이트를 나타냅니다. 구현하는 코드는 다음과 같습니다 :

prefix : = strings.Split (r.Host ".")

if prefix [0] == "en"{
i18n.SetLocale ( "en")
} else if prefix [0] == "cn"{
i18n.SetLocale ( "zh-CN")
} else if prefix [0] == "tw"{
i18n.SetLocale ( "zh-TW")
}

도메인 이름으로 Locale 설정은 위에서 설명한 것과 같은 장점이 있습니다. 그러나 일반적으로 Web 응용 프로그램을 개발하는 경우 이러한 방법은 채택되지 않습니다. 왜냐하면 우선 도메인은 비용이 비교적 높고, Locale를 하나 개발하는 데 하나 도메인 이름을 필요로하기 때문입니다. 또한 종종 통일 된 도메인 이름을 신청 할 수 있는지 모르겠습니다. 다음 각 사이트에 대해 지역화라는 하나의 설정을하고 싶지 아니라 url 뒤에 파라미터를 추가하는 방법이 채택되기 십상입니다. 아래 소개를 참조하십시오.

### 도메인 매개 변수에서 Locale를 설정
현재 가장 많이 사용되는 Locale 설정 방법은 URL에 매개 변수를 추가하는 것입니다. 예를 들어 www.asta.com/hello?locale=zh 또는 www.asta.com/zh/hello 식으로. 이렇게하여 지역을 설정 할 수 있습니다 :`i18n.SetLocale (params [ "locale"])`.

이러한 설정 방법은 앞서 언급 한 도메인에 의한 Locale 설정의 모든 장점을 대부분 가지고 행복합니다. 이것은 RESTful 방식을 채용하고있어, 불필요한 방법을 추가로 처리 할 필요가 없습니다. 그러나 이러한 방법은 각 link에 해당하는 매개 변수 locale을 추가해야 조금 복잡 꽤 귀찮은 경우도 있습니다. 그러나 일반적인 함수 url을 작성하여 모든 link 주소를이 함수를 통해 생성 할 수 있습니다. 이 함수는`locale = params [ "locale"]`매개 변수를 추가하여 귀찮아을 완화시킵니다.

URL 주소를 더 RESTful 외형으로 싶을지도 모릅니다. 예 : www.asta.com/en/books (영어 사이트)과 www.asta.com/zh/books (중국어 사이트). 이러한 방법의 URL은 또한 SEO에 효과적입니다. 또한 사용성도 좋고, URL에서 직관적으로 액세스하는 사이트를 알 수 있습니다. 이러한 URL 주소는 router를 사용하여 locale을 가져옵니다 (REST 절에서 소개 한 router 플러그인 구현을 참고하십시오) :

mux.Get ( "/ : locale / books"listbook)

### 클라이언트 로케일을 설정
있는 특수한 상황에서는 URL이 아니라 클라이언트의 정보에서 Locale를 설정해야합니다. 이 정보는 클라이언트에서 설정된 언어 (브라우저에서 설정되어 있습니다)이나 사용자의 IP 주소 사용자가 등록 할 때 입력 한 위치 정보 등 수 있을지도 모릅니다. 이러한 방법은 Web을 기반으로하는 응용 프로그램에 비교적 맞는 있습니다.

- Accept-Language

클라이언트가 요청했을 때 HTTP 헤더 정보에는`Accept-Language` 있습니다. 일반 클라이언트는이 정보를 설정합니다. 다음은 Go 언어로 구현 한`Accept-Languge` 따라 로케일을 설정하는 간단한 코드입니다 :

AL : = r.Header.Get ( "Accept-Language")
if AL == "en"{
i18n.SetLocale ( "en")
} else if AL == "zh-CN"{
i18n.SetLocale ( "zh-CN")
} else if AL == "zh-TW"{
i18n.SetLocale ( "zh-TW")
}

당연히 실제 응용 프로그램에서는 더 엄격하게 판단하여 로케일 설정을 할 필요가 있을지도 모릅니다
- IP 주소

또 클라이언트에서 로케일을 설정하는 방법은 사용자 액세스의 IP입니다. 해당 IP 라이브러리가 지원하는 액세스 IP를 로케일합니다. 현재 전 세계적으로 비교적 잘 사용되고있는 것은 GeoIP Lite Country라는 라이브러리입니다. 이러한 로케일 설정 메커니즘은 매우 간단하고, IP​​ 데이터베이스에서 사용자의 IP를 검색하면 국가와 지역이 되돌아옵니다. 반환 된 결과에 따라 대응하는 로케일을 설정합니다.

- 사용자 profile

당연히 사용자에게 귀하가 제공하는 셀렉트 박스 및 기타 어떠한 방법으로 대응하는 locale을 설정 할 수 있습니다. 사용자가 입력 한 정보를이 계정 관련 profile에 저장하고 사용자가 다시 로그인 할 때이 설정을 locale 설정에 복사합니다. 이에 따라이 사용자마다 액세스에서 자신이 이전에 설정 한 locale을 기초로 페이지를 얻을 수 있도록 보장 할 수 있습니다.

## 정리
위의 소개에서 Locale의 설정에는 여러 가지 방법이 있다고 밝혀졌습니다. 요구의 차이에 따라 다를 Locale의 설정 방법을 선택해야합니다. 사용자가 가장 잘 아는 방법으로 우리가 제공하는 서비스를 얻기위한 응용 프로그램의 가용성을 향상시킵니다.

